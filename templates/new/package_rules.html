{% extends "new/base.html" %}
{% load emojificate i18n package_tags page_metadata_tags %}

{% block metadata %}
    {% page_metadata page_title=package.title|emojify|emojificate page_description=package.repo_description page_keywords=package.grid_set.all|join:',' og_image_url=package.get_opengraph_image_url %}
{% endblock metadata %}

{% block content %}
    <!-- Breadcrumb Section -->
    <section class="py-4 bg-primary/10">
        <div class="container px-4 mx-auto">
            <div class="flex items-center text-sm text-muted-foreground">
                <a href="{% url 'home' %}" class="hover:underline">{% translate "Home" %}</a>
                <span class="mx-2">»</span>
                <a href="{% url 'packages' %}" class="hover:underline">{% translate "Packages" %}</a>
                <span class="mx-2">»</span>
                <a href="{{ package.get_absolute_url }}" class="hover:underline">{{ package.title }}</a>
                <span class="mx-2">»</span>
                <span class="font-medium text-foreground truncate">{% translate "Rules" %}</span>
            </div>
        </div>
    </section>

    <div class="container py-8 px-4 mx-auto">
        <div class="mb-10 text-center">
            <h1 class="text-3xl font-bold md:text-4xl text-foreground">
                {% translate "Package Score" %}: {{ package_score.total_score }}
            </h1>
            <p class="mt-2 mb-6 text-base text-muted-foreground">{{ package_score.message }}</p>
        </div>

        <div class="card">
            <div class="p-6 card-content">
                <div class="overflow-x-auto">
                    <table class="w-full text-left border-collapse">
                        <thead>
                            <tr class="border-b border-border">
                                <th class="py-3 px-4 font-semibold">{% translate "Rule" %}</th>
                                <th class="py-3 px-4 font-semibold">{% translate "Description" %}</th>
                                <th class="py-3 px-4 font-semibold">{% translate "Score" %}</th>
                                <th class="py-3 px-4 font-semibold">{% translate "Max Score" %}</th>
                                <th class="py-3 px-4 font-semibold">{% translate "More Info" %}</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for breakdown in package_score.breakdown %}
                                <tr class="border-b last:border-0 border-border hover:bg-muted/50">
                                    <td class="py-3 px-4">{{ breakdown.rule }}</td>
                                    <td class="py-3 px-4">{{ breakdown.description }}</td>
                                    <td class="py-3 px-4">{{ breakdown.score }}</td>
                                    <td class="py-3 px-4">{{ breakdown.max_score }}</td>
                                    <td class="py-3 px-4">
                                        {% if breakdown.documentation_url %}
                                            <a href="{{ breakdown.documentation_url }}" class="hover:underline text-primary">{% translate "Details" %}</a>
                                        {% endif %}
                                    </td>
                                </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <div class="mt-8 card">
            <div class="p-6 card-content">
                <pre class="p-4 font-mono text-sm whitespace-pre-wrap break-words rounded bg-muted">package_score:: {{ package_score }}</pre>
            </div>
        </div>
    </div>
{% endblock content %}
