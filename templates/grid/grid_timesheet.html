{% extends "base.html" %}
{% load i18n page_metadata_tags static %}

{% block metadata %}
    {% translate "Timesheet for " as trans_title %}
    {% page_metadata page_title=trans_title|add:grid.title %}
{% endblock metadata %}

{% block extra_head %}
    <link href="{% static 'css/timesheet.css' %}" media="all" rel="stylesheet" />
    <style>
        /* Keep large grids from overflowing the page */
        .timesheet-scroll {
            width: 100%;
            overflow-x: auto;
            overflow-y: hidden;
            -webkit-overflow-scrolling: touch;
        }

        #timesheet.timesheet .data {
            height: calc(100% - 28px);
            overflow-y: auto;
            overflow-x: hidden;
        }
    </style>
{% endblock extra_head %}

{% block content %}
    <!-- Breadcrumb Section -->
    <section class="py-4 bg-primary/10">
        <div class="container px-4 mx-auto">
            <div class="flex items-center text-sm text-muted-foreground">
                <a href="{% url 'home' %}" class="hover:underline">{% translate "Home" %}</a>
                <span class="mx-2">»</span>
                <a href="{% url 'grids' %}" class="hover:underline">{% translate "Grids" %}</a>
                <span class="mx-2">»</span>
                <a href="{% url 'grid' grid.slug %}" class="hover:underline">{{ grid.title }}</a>
                <span class="mx-2">»</span>
                <span class="font-medium text-foreground truncate">{% translate "Timesheet" %}</span>
            </div>
        </div>
    </section>

    <div class="container py-8 px-4 mx-auto">
        <div class="mb-10 text-center">
            <h1 class="text-3xl font-bold md:text-4xl text-foreground">{% translate "Grid Time Table" %}</h1>
            <p class="mt-2 mb-6 text-xl text-muted-foreground">{% translate "Timesheet for " %}{{ grid.title }}</p>
        </div>

        <div class="card">
            <div class="p-6 card-content">
                <div class="timesheet-scroll">
                    <div id="timesheet"></div>
                </div>
            </div>
        </div>
    </div>
{% endblock content %}

{% block extra_js %}
    <script src="{% static 'js/timesheet.js' %}" type="text/javascript"></script>
    <script type="text/javascript">
        {% now "Y" as current_year %}
        new Timesheet('timesheet', {{ current_year|add:"-5" }}, {{ current_year }}, [
            {% for grid_package in grid_packages %}
                {% with package=grid_package.package %}
                    ['{{ package.created|date:"m/Y" }}', '{{ package.last_commit_date|date:"m/Y" }}', '{{ package.slug }}', ''],
                {% endwith %}
            {% endfor %}
        ]);
    </script>
{% endblock extra_js %}
