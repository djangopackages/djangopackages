{% extends "base.html" %}

{% load humanize i18n package_tags page_metadata_tags waffle_tags %}

{% block metadata %}
    {% page_metadata page_title=title %}
{% endblock metadata %}

{% block content %}
    <!-- Breadcrumb Section -->
    <section class="py-4 bg-primary/10">
        <div class="container px-4 mx-auto">
            <div class="flex flex-col gap-3 sm:flex-row sm:justify-between sm:items-center">
                <div class="flex items-center text-sm text-muted-foreground">
                    <a href="{% url 'home' %}" class="hover:underline">{% translate "Home" %}</a>
                    <span class="mx-2">Â»</span>
                    <span class="font-medium text-foreground truncate">{{ title }}</span>
                </div>
                <div class="flex flex-wrap gap-2 items-center w-full sm:w-auto">
                    <a href="{% url 'add_package' %}" class="flex-1 flex-shrink-0 sm:flex-none btn-secondary">
                        <i class="mr-1 text-base ph-bold ph-plus"></i>
                        <span>{% translate "Add Package" %}</span>
                    </a>
                </div>
            </div>
        </div>
    </section>

    <div class="container py-8 px-4 mx-auto">
        <div class="mb-8">
            <h1 class="text-3xl font-bold text-foreground">{{ heading }}</h1>
        </div>

        {% include "partials/_ethicalads-tag.html" with ea_type="text" ea_id="archive-list-inline" ea_outer_class="mb-4" ea_inner_class="flex justify-center" %}

        <div class="card">
            <div class="p-6 card-content">
                <div class="overflow-x-auto w-full">
                    <table class="w-full text-sm text-left">
                        <thead>
                            <tr class="text-left border-b">
                                <th class="pr-6 pb-3 font-medium text-muted-foreground">
                                    <div class="flex gap-1 items-center">
                                        <i class="text-lg ph-bold ph-package"></i>
                                        {% translate "Title" %}
                                    </div>
                                </th>
                                <th class="hidden pb-3 font-medium sm:table-cell text-muted-foreground">
                                    <div class="flex gap-1 items-center">
                                        <i class="text-lg ph-bold ph-tag"></i>
                                        {% translate "Category" %}
                                    </div>
                                </th>
                                <th class="pb-3 font-medium text-muted-foreground">
                                    <div class="flex gap-1 items-center">
                                        <i class="text-lg ph-bold ph-star"></i>
                                        <span class="sm:inline">{% translate "Stars" %}</span>
                                    </div>
                                </th>
                                <th class="pb-3 font-medium text-muted-foreground">
                                    <div class="flex gap-1 items-center">
                                        <i class="text-lg ph-bold ph-git-fork"></i>
                                        <span class="sm:inline">{% translate "Forks" %}</span>
                                    </div>
                                </th>
                                <th class="hidden pb-3 font-medium lg:table-cell text-muted-foreground">
                                    <div class="flex gap-1 items-center">
                                        <i class="text-lg ph-bold ph-clock"></i>
                                        {% translate "Updated" %}
                                    </div>
                                </th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for package in packages %}
                                <tr class="border-b transition-colors last:border-0 hover:bg-muted/30">
                                    <td class="py-3 pr-6 max-w-[10rem] sm:max-w-[15rem] md:max-w-[20rem]">
                                        <div class="flex flex-col">
                                            <a href="{% url 'package' package.slug %}" class="block text-base font-semibold hover:underline text-primary truncate" title="{{ package.title }}">{{ package.title }}</a>
                                            <p class="mt-1 text-xs text-muted-foreground truncate" title="{{ package.repo_description|default:"" }}">{{ package.repo_description|default:"" }}</p>

                                                <!-- Mobile/Tablet Badges -->
                                            <div class="flex flex-wrap gap-2 mt-2">
                                                {% if package.category %}
                                                    <span class="inline-flex items-center py-0.5 px-2 text-xs font-medium rounded sm:hidden bg-secondary text-secondary-foreground">
                                                        {{ package.category.title }}
                                                    </span>
                                                {% endif %}

                                                <span class="inline-flex items-center py-0.5 px-2 text-xs font-medium rounded lg:hidden bg-muted text-muted-foreground" title="{% translate 'Last Updated' %}">
                                                    <i class="mr-1 ph-bold ph-clock"></i> {{ package.last_fetched|date:"M d, Y"|default:"-" }}
                                                </span>
                                            </div>
                                        </div>
                                    </td>
                                    <td class="hidden py-3 sm:table-cell">
                                        {% if package.category %}
                                            <span class="inline-flex items-center py-0.5 px-2.5 text-xs font-medium rounded-full bg-secondary text-secondary-foreground hover:bg-secondary/80">
                                                {{ package.category.title }}
                                            </span>
                                        {% endif %}
                                    </td>
                                    <td class="py-3 font-mono text-sm">
                                        {{ package.repo_watchers|intcomma|default:"-" }}
                                    </td>
                                    <td class="py-3 font-mono text-sm">
                                        {{ package.repo_forks|intcomma|default:"-" }}
                                    </td>
                                    <td class="hidden py-3 text-sm lg:table-cell text-muted-foreground">
                                        {{ package.last_fetched|date:"M d, Y"|default:"-" }}
                                    </td>
                                </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
{% endblock content %}
